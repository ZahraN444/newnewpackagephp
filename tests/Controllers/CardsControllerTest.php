<?php

declare(strict_types=1);

/*
 * LobLib
 *
 * This file was automatically generated by APIMATIC v3.0 ( https://www.apimatic.io ).
 */

namespace LobLib\Tests\Controllers;

use Core\TestCase\BodyMatchers\KeysBodyMatcher;
use Core\TestCase\TestParam;
use LobLib\Controllers\CardsController;
use LobLib\Exceptions;
use LobLib\Models;

class CardsControllerTest extends BaseTestController
{
    /**
     * @var CardsController CardsController instance
     */
    protected static $controller;

    /**
     * Setup test class
     */
    public static function setUpBeforeClass(): void
    {
        self::$controller = parent::getClient()->getCardsController();
    }

    public function testCardsList()
    {
        // Parameters for the API call
        $limit = 10;
        $beforeAfter = null;
        $mInclude = null;

        // Perform API call
        $result = null;
        try {
            $result = self::$controller->cardsList($limit, $beforeAfter, $mInclude);
        } catch (Exceptions\ApiException $e) {
        }

        $headers = [];
        $headers['Content-Type'] = ['application/json', true];

        // Assert result with expected response
        $this->newTestCase($result)
            ->expectStatus(200)
            ->allowExtraHeaders()
            ->expectHeaders($headers)
            ->bodyMatcher(KeysBodyMatcher::init(TestParam::object(
                '{"data":[{"id":"card_7a6d73c5c8457fc","account_id":"fa9ea650fc7b31a89f92","des' .
                'cription":null,"url":"https://lob-assets.com/cards/card_c51ae96f5cebf3e.pdf?ver' .
                'sion=v1&expires=1636910992&signature=mnsDH2DAxdkN9VibdlLMxJC86sME5WYDqkNtmvGwdN' .
                'sAaUWfbnv0rJhJ1mR8Ol4uxQq61j5wYZ0r3s-lBkQfDA","size":"2.125x3.375","auto_reorde' .
                'r":false,"reorder_quantity":null,"raw_url":"https://lob-assets.com/cards/card_c' .
                '51ae96f5cebf3e_raw.pdf?version=v1&expires=1636910992&signature=-bZo31FMAp2vmNaZ' .
                'KyXn_Qa4APqwtNinw76FrQ7uyQejFZw6VBQQYfoiQ642iXh0H2K5i2aOo8_BAkt3UJdVDw","front_' .
                'original_url":"https://lob-assets.com/cards/card_c51ae96f5cebf3e_raw.pdf?versio' .
                'n=v1&expires=1636910992&signature=-bZo31FMAp2vmNaZKyXn_Qa4APqwtNinw76FrQ7uyQejF' .
                'Zw6VBQQYfoiQ642iXh0H2K5i2aOo8_BAkt3UJdVDw","back_original_url":"https://lob-ass' .
                'ets.com/cards/card_c51ae96f5cebf3e_raw.pdf?version=v1&expires=1636910992&signat' .
                'ure=-bZo31FMAp2vmNaZKyXn_Qa4APqwtNinw76FrQ7uyQejFZw6VBQQYfoiQ642iXh0H2K5i2aOo8_' .
                'BAkt3UJdVDw","thumbnails":[{"small":"https://lob-assets.com/cards/card_c51ae96f' .
                '5cebf3e_thumb_small_1.png?version=v1&expires=1636910992&signature=mrv8JDvpZK4I8' .
                'WUGH0tPdtK-My5oes0Ltj_gL7BDw96SpCTTeZFHkz81SzclyFP9dQRtlsvAsjcuGcTBvCvOCg","med' .
                'ium":"https://lob-assets.com/cards/card_c51ae96f5cebf3e_thumb_medium_1.png?vers' .
                'ion=v1&expires=1636910992&signature=VgL_2Ckm_kxKiWGgWtdNoy9HHOn8dGYSVOn7UqyCbwd' .
                'bVlUtx28TRN4Bo8Iru3n0keKp9He0YhKT1ILotznMDA","large":"https://lob-assets.com/ca' .
                'rds/card_c51ae96f5cebf3e_thumb_large_1.png?version=v1&expires=1636910992&signat' .
                'ure=FKSzymA13j-CQ0uk20cGHZTzT3vimzNBYrgp-xifLFg4mMdo1BZALR5O0aF_jVhsX614hKP35ON' .
                'dYl47TQxXAw"}],"available_quantity":10000,"pending_quantity":0,"countries":null' .
                ',"status":"rendered","mode":"test","orientation":"horizontal","threshold_amount' .
                '":0,"date_created":"2021-03-24T22:51:42.838Z","date_modified":"2021-03-24T22:51' .
                ':42.838Z","send_date":"2021-03-24T22:51:42.838Z","object":"card"}],"object":"li' .
                'st","previous_url":null,"next_url":null,"count":1}'
            )))
            ->assert();
    }

    public function testCardCreate()
    {
        // Parameters for the API call
        $body = TestParam::object(
            '{"description":"Test card","front":"https://s3-us-west-2.amazonaws.com/public.lob.' .
            'com/assets/card_horizontal.pdf","back":"https://s3-us-west-2.amazonaws.com/public.l' .
            'ob.com/assets/card_horizontal.pdf","size":"2.125x3.375"}',
            Models\CardEditable::class
        );

        // Perform API call
        $result = null;
        try {
            $result = self::$controller->cardCreate($body);
        } catch (Exceptions\ApiException $e) {
        }

        $headers = [];
        $headers['Content-Type'] = ['application/json', true];

        // Assert result with expected response
        $this->newTestCase($result)
            ->expectStatus(200)
            ->allowExtraHeaders()
            ->expectHeaders($headers)
            ->bodyMatcher(KeysBodyMatcher::init(TestParam::object(
                '{"id":"card_7a6d73c5c8457fc","account_id":"fa9ea650fc7b31a89f92","description"' .
                ':"Test card","url":"https://lob-assets.com/cards/card_c51ae96f5cebf3e.pdf?versi' .
                'on=v1&expires=1636910992&signature=mnsDH2DAxdkN9VibdlLMxJC86sME5WYDqkNtmvGwdNsA' .
                'aUWfbnv0rJhJ1mR8Ol4uxQq61j5wYZ0r3s-lBkQfDA","size":"2.125x3.375","auto_reorder"' .
                ':false,"reorder_quantity":null,"raw_url":"https://lob-assets.com/cards/card_c51' .
                'ae96f5cebf3e_raw.pdf?version=v1&expires=1636910992&signature=-bZo31FMAp2vmNaZKy' .
                'Xn_Qa4APqwtNinw76FrQ7uyQejFZw6VBQQYfoiQ642iXh0H2K5i2aOo8_BAkt3UJdVDw","front_or' .
                'iginal_url":"https://lob-assets.com/cards/card_c51ae96f5cebf3e_raw.pdf?version=' .
                'v1&expires=1636910992&signature=-bZo31FMAp2vmNaZKyXn_Qa4APqwtNinw76FrQ7uyQejFZw' .
                '6VBQQYfoiQ642iXh0H2K5i2aOo8_BAkt3UJdVDw","back_original_url":"https://lob-asset' .
                's.com/cards/card_c51ae96f5cebf3e_raw.pdf?version=v1&expires=1636910992&signatur' .
                'e=-bZo31FMAp2vmNaZKyXn_Qa4APqwtNinw76FrQ7uyQejFZw6VBQQYfoiQ642iXh0H2K5i2aOo8_BA' .
                'kt3UJdVDw","thumbnails":[{"small":"https://lob-assets.com/cards/card_c51ae96f5c' .
                'ebf3e_thumb_small_1.png?version=v1&expires=1636910992&signature=mrv8JDvpZK4I8WU' .
                'GH0tPdtK-My5oes0Ltj_gL7BDw96SpCTTeZFHkz81SzclyFP9dQRtlsvAsjcuGcTBvCvOCg","mediu' .
                'm":"https://lob-assets.com/cards/card_c51ae96f5cebf3e_thumb_medium_1.png?versio' .
                'n=v1&expires=1636910992&signature=VgL_2Ckm_kxKiWGgWtdNoy9HHOn8dGYSVOn7UqyCbwdbV' .
                'lUtx28TRN4Bo8Iru3n0keKp9He0YhKT1ILotznMDA","large":"https://lob-assets.com/card' .
                's/card_c51ae96f5cebf3e_thumb_large_1.png?version=v1&expires=1636910992&signatur' .
                'e=FKSzymA13j-CQ0uk20cGHZTzT3vimzNBYrgp-xifLFg4mMdo1BZALR5O0aF_jVhsX614hKP35ONdY' .
                'l47TQxXAw"},{"small":"https://lob-assets.com/cards/card_c51ae96f5cebf3e_thumb_s' .
                'mall_2.png?version=v1&expires=1636910992&signature=IWsmPa_ULlv2yyqjX564d_YfHHY_' .
                'M7i9YxDnw-WXDr2jtOFcArmRZQbnHeE9g_rYxnddJbgosuv8-c2utiu7Cg","medium":"https://l' .
                'ob-assets.com/cards/card_c51ae96f5cebf3e_thumb_medium_2.png?version=v1&expires=' .
                '1636910992&signature=zxK7VKGiTvz5Ywrkaydd0v3GcYf58R7A08J4tNfI7-aiNODDcTF3l0MqY1' .
                '3n9Pyc8RXSdD0XVBY-OpbA1VM-Ag","large":"https://lob-assets.com/cards/card_c51ae9' .
                '6f5cebf3e_thumb_large_2.png?version=v1&expires=1636910992&signature=r0OFUhh315Z' .
                'wN0raMZdIwJd2oCIEYsz0BABaMxIuO1PKTD0ckGWrhcGdzk2dlWQ6vSvp0CUQ5k1RXGqkIIqkDw"}],' .
                '"available_quantity":10000,"pending_quantity":0,"countries":null,"status":"rend' .
                'ered","mode":"test","orientation":"horizontal","threshold_amount":0,"date_creat' .
                'ed":"2021-03-24T22:51:42.838Z","date_modified":"2021-03-24T22:51:42.838Z","send' .
                '_date":"2021-03-24T22:51:42.838Z","object":"card"}'
            )))
            ->assert();
    }
}
